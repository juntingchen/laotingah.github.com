
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>laoting</title>
  <meta name="author" content="laoting">

  
  <meta name="description" content="更换Kindle字体指南（基于Kindle 4和Mac OS） 这是一篇更换Kindle字体的快速指南，不要求读者有任何技术背景。对于没有任何经验的用户，完成以下步骤大概需要20分钟。
本文基于@miaoo的《Kindle 4更换中文字体》，但针对Mac OS用户提供了更为简捷的ssh方法（ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://laotingah.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="laoting" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">laoting</a></h1>
  
    <h2>Freedom is an attitude to pursuit your dream</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:laotingah.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/21/kindle-4-change-fonts-on-mac-os/">Kindle 4: Change Fonts on Mac OS</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-21T19:35:00+08:00" pubdate data-updated="true">Jan 21<span>st</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>更换Kindle字体指南（基于Kindle 4和Mac OS）</h2>

<p>这是一篇更换Kindle字体的快速指南，不要求读者有任何技术背景。对于没有任何经验的用户，完成以下步骤大概需要20分钟。
本文基于<a href="http://miaoo.in">@miaoo</a>的《<a href="http://miaoo.in/kindle4-modify-font.html">Kindle 4更换中文字体</a>》，但针对Mac OS用户提供了更为简捷的ssh方法（下文介绍）。更换字体的原因是Kindle1-4上默认的中文字体Het显示较为粗糙，读者会希望更换更舒服的字体（比如宋体）。</p>

<h3>1、准备想要更换的字体</h3>

<p>准备两种字体文件，普通字体用于显示正文以及粗体用于显示标题，分别命名为CJK.ttf和CJK_Bold.ttf。
一般认为比较舒服的是方正雅宋和方正特雅宋，可以在<a href="http://ishare.iask.sina.com.cn/f/22080046.html">这里</a>下载。</p>

<h3>2、获取Kindle序列号和root密码</h3>

<p>序列号可在Menu->Settings->Device Info找到（Serial Number）。root密码可以通过<a href="http://miaoo.in/kindle4-modify-font.html">这个帖子</a>破解。但如果Kindle版本为4.0，则root密码为&#8221;mario&#8221;（不含引号）。</p>

<h3>3、将字体文件传输到Kindle</h3>

<p>连接Kindle到电脑，将两个字体文件CJK.ttf和CJK_Bold.ttf拷贝到 documents/目录下。</p>

<h3>4、进入调试模式</h3>

<p>在Kindle根目录下创建一个名为“ENABLE_DIAGS”的空文件夹。重启设备，Menu->Settings->menu->restart.(注：Menu是指菜单按钮。)</p>

<h3>5、开启USBnet模式</h3>

<p>设备进入调试模式后，根据导航菜单依次进入Misc individual diagnostics -> Utilities -> Enable USBnet。看到&#8221;PASS“以后，按右方向键(FW Right)确认，屏幕将返回上层菜单。</p>

<h3>6、在Mac OS中为Kindle配置IP地址</h3>

<p>在Mac OS中打开系统偏好（System preferences），打开”网络(Network)&#8221;，在左栏将看到一个叫”RNDIS/Ethernet Gadget&#8221;的设备。将IP地址配置方式设为“手动（Manually）”，设置IP地址（IP Address）为192.168.15.1，子网掩码（Subnet Mask）为255.255.255.0.</p>

<p><img src="/images/2013-01-21-kindle-4-change-fonts/networking1.jpg"></p>

<h3>7、ssh登录Kindle</h3>

<p>打开终端(Terminal)。这东西一般在应用程序(Applications)->实用工具(Utilities)里。输入以下命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh root@192.168.15.244</span></code></pre></td></tr></table></div></figure>


<p>终端将会提示输入密码，即是第2步获取的root密码。注意，输入密码过程屏幕不会有任何显示，输入完毕后直接按回车即可。
连接成功后，终端提示符将变为</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root></span></code></pre></td></tr></table></div></figure>


<h3>8、拷贝字体文件到系统目录</h3>

<p>依次输入以下命令</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mntroot rw
</span><span class='line'>mount /dev/mmcblk0p1 /mnt/base-mmc
</span><span class='line'>cp /mnt/base-us/documents/CJK.ttf /mnt/base-mmc/usr/java/lib/fonts/
</span><span class='line'>cp /mnt/base-us/documents/CJK_Bold.ttf /mnt/base-mmc/usr/java/lib/fonts/</span></code></pre></td></tr></table></div></figure>


<p>第一条命令是将系统目录权限改为可读写。第二条命令是挂在系统目录。最后两条命令是将两个字体文件从用户目录复制到系统的字体目录。读者可以看到，在系统字体目录usr/java/lib/fonts/下还有其他字体文件。</p>

<h3>9、修改系统字体设置</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cd /mnt/base-mmc/usr/java/lib/
</span><span class='line'>cp font.properties font.properties.bak
</span><span class='line'>vi font.properties</span></code></pre></td></tr></table></div></figure>


<p>上面第一条命令是进入系统库目录。第二条命令是备份原有的字体设置文件。第三条命令是打开vi编辑器修改字体设置文件。</p>

<p>在vi中找到如下行，</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hans.0=MHeiM18030_E.ttf
</span><span class='line'>hans.plain=MHeiM18030_E.ttf
</span><span class='line'>hans.1=MHeiM18030_E_Bold.ttf
</span><span class='line'>hans.bold=MHeiM18030_E_Bold.ttf</span></code></pre></td></tr></table></div></figure>


<p>按 i 键进入编辑模式，将其修改为</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hans.0=CJK.ttf
</span><span class='line'>hans.plain=CJK.ttf
</span><span class='line'>hans.1=CJK_Bold.ttf
</span><span class='line'>hans.bold=CJK_Bold.ttf</span></code></pre></td></tr></table></div></figure>


<p>保存退出(按ESC，输入 :wq)。注意，要输入冒号&#8221;:&#8221;。
最后重新设定系统目录的只读权限：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mntroot ro</span></code></pre></td></tr></table></div></figure>


<h3>10、退出调试模式</h3>

<p>关闭终端(Terminal）。在Kindle上返回主菜单，可一直按方向键右键(FW Right)。然后依次进入Exit, Reboot or Disable Diags -> Disable Diagnostics。屏幕询问&#8221;Are you sure&#8221;时，按方向键左键(FW Left)退出。
设备将重启并回到正常模式。
字体修改设置完成！</p>

<h3>FAQ</h3>

<ul>
<li>为何有些书籍中文显示仍粗糙？</li>
</ul>


<p>Ans：通常的原因是书籍未标明语言。解决方法是用<a href="http://calibre-ebook.com/download_osx">Calibre</a>修改书籍的元数据，将其标明为中文。</p>

<p><img src="/images/2013-01-21-kindle-4-change-fonts/Calibre1.jpg"></p>

<p>另一种方法是直接指定显示语言，如下。
在Kindle上按Home键回到主界面，然后按键盘键调出键盘。输入</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>;debugOn
</span><span class='line'>~changeLocale zh-CN.utf8
</span><span class='line'>;debugOff</span></code></pre></td></tr></table></div></figure>


<p>注意要输入分号“;”和波浪号“~&#8221;，注意大小写，以及每一行输入完毕后输入”回车符”。每行输入完后，屏幕不会有特别显示的。</p>

<h3>其他相关资源</h3>

<ul>
<li>中文字典：<a href="http://tumutanzi.com/archives/5465">这里</a>有比较多的Kindle中文电子词典。但比较鸡肋的是，大部分词典不支持单复数，比如类似virtues这样的单词就不认识了。感觉还是没有系统自带的词典好。</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/11/07/lyx-section-label-issue/">LyX Section Label Issue</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-11-07T22:32:00+08:00" pubdate data-updated="true">Nov 7<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It had been a headache to me for over 2 days dealing with the section label problem in LyX. It ended up with a bug report sent to both LyX developer forum and the author of spconf.sty, an IEEE paper formatting package for LaTeX. The turn out is the LyX developers have found an alternative solution years ago and they insist to &#8221;<em>educating the user by making it impossible to put a label in a section</em>&#8221;. Therefore, I find it necessary to broadcast this to the potential LyX rookies.</p>

<p>The story is the following. If you put a label in the environment of a section just following the section name (sounds quite logical, isn&#8217;t it?), LyX generates the LaTeX source as follows,</p>

<p>LyX source:</p>

<p><img src="/images/2012-11-07-lyx-section-label-issue/section_label_1.png"></p>

<p>LaTeX source output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\subsection{Two Timescale User Scheduling \label{sub:Two-Timescale-scheduling}}</span></code></pre></td></tr></table></div></figure>


<p>Note that the \label{} is placed within the section macro. This is fine in general, but it may generate problems for some package, e.g. the spconf.sty package. Using spconf.sty, you may encounter this warning</p>

<p><em>LaTeX Warning: Reference &#8216;sub:Two-Timescale-scheduling&#8217; underfined</em></p>

<p>It is said that it generate spurious latex errors when using &#8220;non-latin 1 codepages&#8221; [1].</p>

<p>The LyX forum suggest to label the section in this way,</p>

<p>LyX Source:</p>

<p><img src="/images/2012-11-07-lyx-section-label-issue/section_label_2.png"></p>

<p>Then the LaTeX source will be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>\subsection{Two Timescale User Scheduling}
</span><span class='line'>
</span><span class='line'>\label{sub:Two-Timescale-scheduling}
</span><span class='line'>
</span><span class='line'>Conventional throughput optimal (in stability ...</span></code></pre></td></tr></table></div></figure>


<p>which follows the LaTeX code convention.</p>

<p>So the conclusion is, so avoid various mysterious trouble, just change your LyX code habit!</p>

<p>See also:
[1] The LyX project ticket track <a href="http://www.lyx.org/trac/ticket/2154">#2154</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/10/30/export-lyx-to-ms-word/">Export LyX to MS Word</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-30T20:55:00+08:00" pubdate data-updated="true">Oct 30<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Normally, we seldom put a LyX document into Word, since the reason we use LyX is for better handling the math equations and the layout, which MS Word is truly bad at. However, you might probably run into a situation one day that your boss requests only a Word document. Then you need the exporting. As you may know, the equations would be your nightmare.</p>

<p>I have just exported a long LyX document into two 70-page MS Word documents. One is a survey report, mixed with text, pictures and equations, and, another is a technical report, pages of mathematics equations. I actually spent 10+ hours for the whole process, including a couple of hours searching for a one-off exporting method (of course, it does not exist!) and a painful night for fine-tuning the exported Word document.</p>

<p>I will show my final way to get it through, and compare with my other attempts.</p>

<h2>General approaches</h2>

<p>There is a comprehensive overview for the exporting LaTeX to other text-processor available in <a href="http://www.tug.org/utilities/texconv/textopc.html">TUG</a>. Here is a summary of my attempts, in particular useful as reference for LyX users.</p>

<ol>
<li><p><strong>Directly type the text and equation to Word</strong></p>

<ul>
<li>Pros: keeping the beautiful and editable math equations, and best for short documents</li>
<li>Cons: It would be a disaster for long documents.</li>
<li>Tips: You can just copy and paste the body of LyX document to Word. The math equations will expand into LaTeX format, which you can convert by <a href="http://www.dessci.com/en/products/mathtype/">MathType</a> or <a href="http://elevatorlady.ca/index.html">Aurora</a>. <a href="http://www.dessci.com/en/products/mathtype/">MathType</a> now can support direct simple LaTeX input. <a href="http://elevatorlady.ca/index.html">Aurora</a> is a Word add-in that supports more complex LaTeX semantics, but it is commercial.</li>
</ul>


<p> Note: It is worthy to note the “Paste from TeX” function of the Aurora add-in. You can copy a paragraph from TeX source to the clipboard, and then migrate the content to Word using this function. The equations are beautifully converted to Aurora objects. However, the cross-reference, citations and numbering are not handled.</p></li>
<li><p><strong>Use a Word import filter</strong></p>

<ul>
<li>Pros: exporting long documents at instance, keeping most structural/font formatting styles, fully editable math equations, and on-off solution for documents with only simple equations</li>
<li>Cons: usually commercial, may not support complex LaTeX equations, and usually cannot translate all your complex symbols</li>
</ul>


<p> I tried <a href="http://www.chikrii.com/products/tex2word/">TeX2Word</a>. It costs USD99, but you can always download a trial version (only translate 3 pages) first and buy after you have tested everything fine. Note that capability for transforming math equations is dominated by the Word add-in <a href="http://www.dessci.com/en/products/mathtype/">MathType</a>. For example, <a href="http://www.chikrii.com/products/tex2word/">TeX2Word 2.0</a> even cannot recognize $\mathcal{}$ and results in an fatal error. For the <a href="http://www.chikrii.com/products/tex2word/">TeX2Word 3.0</a> version, it leaves a blank for the $\mathcal{}$, and you need to check line by line for you equations.</p></li>
<li><p><strong>LyX -> LaTeX -> RTF -> Word</strong></p>

<p>I tried <a href="http://latex2rtf.sourceforge.net">latex2rtf</a>. It simply stopped at some “unknown control sequence”. I think the results of this solution are just similar as using a Word importer.</p></li>
<li><p><strong>LyX -> HTML -> Word (<em>RECOMMENDED</em>)</strong></p>

<ul>
<li>Pros: suitable for documents with many complex math equations</li>
<li>Cons: need a lot post-fine-tuning</li>
</ul>


<p> It is an intermediate trade-off between methods 1 and 2, and works universally for all kinds of LyX documents. The exporter converts all displayable characters into text (e.g., normal style symbols, superscripts/subscripts) and others into images.</p></li>
</ol>


<h2>Key flows in LyX -> HTML -> Word</h2>

<ol>
<li><p>Open your document in LyX. Export the file using File->Export->HTML. The program will then create a subfolder containing all the images at the same location as your source file.</p></li>
<li><p>Open the largest html file in the subfolder in Word. Select all and copy.</p></li>
<li><p>Create a new document in Word and Paste. Note, this is to keep your document structure, e.g., the title and the levels of headings/sections.</p>

<p>Note: [1] There are a few other options in exporting, e.g., LyxHTML and HTML (MS Word). However, these options simply did not work for me.
[2] The exported cannot support image file type other than EPS (may depend on your LyX and LaTeX package versions). I used <a href="https://www.assembla.com/code/ainotes/subversion/nodes/tools/JPG-PNGtoEPS?rev=13">JPG-PNGTOEPS</a> to batch-convert all my images.</p></li>
<li><p>Find tuning in Word</p>

<ul>
<li><em>Insert all the footnotes</em></li>
</ul>


<p> Footnotes are exported in separated html files in sequence. You need to copy them back into your main Word file.</p>

<ul>
<li><em>Fine tune the images and tables</em></li>
</ul>


<p> Resize the image / substitute the low resolution exported EPS-jpeg images into clearer ones. Give them captions if you may need.</p>

<ul>
<li><em>Fine tune the equations</em></li>
</ul>


<p> The inline layout for equation images may be ugly and need adjusting.</p>

<ul>
<li><em>Break the linked image in Word file (IMPORTANT)</em></li>
</ul>


<p> By default, the images are not stored in the doc file but linked to the exported subfolder. The way to break them is,</p>

<ul>
<li>In Word 2010, first convert the file into .docx format.</li>
<li>Then go to File->Info, at the rightmost, click into “Edit link to Files”.</li>
<li>Inside, select all the graphic files, check the box “Save picture in document” and click “Break Link”.</li>
<li>Then you are done.</li>
</ul>
</li>
</ol>


<h2>Open issues</h2>

<p>Although the LyX -> HTML -> Word method seems to best fit into my situation, it still requires a lot of efforts for fine tuning. What’s more, I spotted some issues and hope someone can help me improve.</p>

<ol>
<li><p>Only EPS image format is supported in LyX->HTML exporting (LyX 2.0.0)</p></li>
<li><p>Low resolution of the converted images</p></li>
<li><p>Incorrect mixed superscript/subscript text for simple math equations</p>

<p>For example, $U_M<sup>2$</sup> would becomes $U_M\,<sup>^2$.</sup> Things get worse with superscript’s superscript, etc. I think the reason is LyX thinks HTML can display such superscripts/subscripts and so that refuse to convert it into images. Would there be a way to force LyX to convert every equation into an image?</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/10/28/hello/">Hello</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-10-28T10:37:00+08:00" pubdate data-updated="true">Oct 28<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Hello, this is my first post.</p>

<p><a href="http://octopress.org">Octopress</a> is a wonderful tool for blogging.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake new_post["title"]
</span><span class='line'>rake generate
</span><span class='line'>rake preview
</span><span class='line'>rake deploy
</span><span class='line'>git add .
</span><span class='line'>git commit -m 'my new post'
</span><span class='line'>git push origin source</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/01/21/kindle-4-change-fonts-on-mac-os/">Kindle 4: Change fonts on Mac OS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/07/lyx-section-label-issue/">LyX section label issue</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/30/export-lyx-to-ms-word/">Export LyX to MS Word</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/28/hello/">Hello</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - laoting -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
